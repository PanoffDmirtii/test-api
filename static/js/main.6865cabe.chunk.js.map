{"version":3,"sources":["hoc/withVisibleTab.js","services/apiService.js","store/constans.js","store/actions/coin.js","components/Coin.js","components/Header.js","components/Home.js","components/Main.js","routing/AppRouter.js","App.js","store/reducers/coin.js","store/index.js","index.js"],"names":["withVisibleTab","WrapperComponent","props","state","isVisibleTab","document","addEventListener","setState","hidden","removeEventListener","data","this","React","Component","req","axios","create","baseURL","coin","get","then","res","constans","SET_COIN_SUCCESS","SET_COIN_FAIL","SET_RANGE_SUCCESS","SET_RANGE_FAIL","startSetCoin","dispatch","type","payload","catch","err","console","log","startSetRange","value","setRange","useDispatch","useSelector","diff","range","useEffect","coinAutoUpdate","setTimeout","startAutoUpdate","clearTimeout","Row","className","Col","price","symbol","persent","parseFloat","toFixed","getDiffPersent","sm","FormGroup","Label","Input","name","defaultValue","onChange","target","Header","to","Home","Main","children","AppRouter","basename","path","exact","component","Coin","render","App","initState","coinReduser","action","_diff","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","reducers","combineReducers","coinReducer","store","createStore","applyMiddleware","thunk","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.6865cabe.chunk.js","sourcesContent":["import React from 'react';\n\nconst withVisibleTab = (WrapperComponent) => {\n  return class extends React.Component {\n    constructor(props) {\n      super(props)\n      this.state = {\n        isVisibleTab: true\n      }\n    }\n\n    componentDidMount() {\n      // для safari не подходит\n      document.addEventListener('visibilitychange', () => this.setState({ isVisibleTab: !document.hidden }))\n    }\n\n    componentWillUnmount() {\n      document.removeEventListener('visibilitychange', () => this.setState({ isVisibleTab: false }))\n    }\n\n    render() {\n      const data = { ...this.props, ...this.state }\n      return (\n        <WrapperComponent {...data} />\n      )\n    }\n  }\n};\n\nexport default withVisibleTab;","import axios from 'axios'\n\nexport const req = axios.create({\n  baseURL: 'https://api.binance.com/api/v3'\n})\n\nexport const coin = {\n  getCoin() {\n    return req.get('/ticker/price?symbol=ETHBTC').then(res => res.data)\n  }\n}","export const constans = {\n  COIN: {\n    SET_COIN_SUCCESS: 'SET_COIN_SUCCESS',\n    SET_COIN_FAIL: 'SET_COIN_FAIL',\n\n    SET_RANGE_SUCCESS: 'SET_RANGE_SUCCESS',\n    SET_RANGE_FAIL: 'SET_RANGE_FAIL'\n  }\n}","import { coin } from \"../../services/apiService\"\nimport { constans } from \"../constans\"\n\nconst setCoin = (data) => {\n  return ({\n    type: constans.COIN.SET_COIN_SUCCESS,\n    payload: data\n  })\n}\n\nconst setRange = (value) => {\n  return ({\n    type: constans.COIN.SET_RANGE_SUCCESS,\n    payload: value\n  })\n}\n\nexport const startSetCoin = () => dispatch => {\n  return coin\n    .getCoin()\n    .then(res => dispatch(setCoin(res)))\n    .catch(err => console.log(err))\n}\n\nexport const startSetRange = (value) => dispatch => {\n  return dispatch(setRange(value))\n}\n","import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Col, FormGroup, Input, Label, Row } from 'reactstrap';\nimport withVisibleTab from '../hoc/withVisibleTab';\nimport { startSetCoin, startSetRange } from '../store/actions/coin';\n\nconst Coin = (props) => {\n  const { isVisibleTab } = props\n  const dispatch = useDispatch()\n  const { data, diff, range } = useSelector(state => state.coin)\n\n  useEffect(() => {\n    dispatch(startSetCoin())\n  }, [])\n\n  useEffect(() => {\n    /**\n     * setInterval для очень коротких интервалов не подойдет.\n     */\n    let coinAutoUpdate = setTimeout(\n      function startAutoUpdate() {\n        if (!isVisibleTab) return\n        dispatch(startSetCoin())\n        coinAutoUpdate = setTimeout(startAutoUpdate, +range * 1000)\n      }, 0)\n    return () => {\n      clearTimeout(coinAutoUpdate)\n    }\n  }, [range, isVisibleTab])\n\n\n  const handleChangeRange = ({ target: { value, name } }) => {\n    dispatch(startSetRange(value))\n  }\n\n  const getDiffPersent = () => {\n    const persent = diff ? parseFloat(diff).toFixed(4) : '0.0000'\n    if (persent > 0) return <span className='text-success'>&#8593; {persent}%</span>\n    else if (persent < 0) return <span className='text-danger'>&#8595; {persent}%</span>\n    else return <span className='text-muted'>{persent}%</span>\n  }\n\n  if (!data) return <div>Loading...</div>\n\n  return (\n    <div>\n      <Row className='flex align-items-center mb-5 justify-content-center'>\n        <Col>\n          <div className='d-flex justify-content-center'>\n            <h3 className='mr-5'>{`${data.price} ${data.symbol}`}</h3>\n            <h3>{getDiffPersent()}</h3>\n          </div>\n        </Col>\n      </Row>\n      <Row className='flex align-items-center mb-3 justify-content-center'>\n        <Col sm='3'>\n          <FormGroup>\n            <Label>Частота обновления</Label>\n            <Input name='range' type='select' defaultValue={range} onChange={handleChangeRange}>\n              <option value='10'>10</option>\n              <option value='3'>3</option>\n              <option value='1'>1</option>\n              <option value='0.4'>0.4</option>\n              <option value='0.1'>0.1</option>\n            </Input>\n          </FormGroup>\n        </Col>\n      </Row>\n    </div>\n  );\n};\n\nexport default withVisibleTab(Coin);","import React from 'react';\nimport { NavLink } from 'react-router-dom'\n\nconst Header = () => {\n  return (\n    <div className='header'>\n      <ul className='nav'>\n        <li className='nav_item'><NavLink to='/test-api'>Home</NavLink></li>\n        <li className='nav_item'><NavLink to='/test-api/coin'>Coin</NavLink></li>\n      </ul>\n    </div>\n  );\n};\n\nexport default Header;","import React from 'react';\n\nconst Home = (props) => {\n  return (\n    <div>\n      Home\n    </div>\n  );\n};\n\nexport default Home;","import React from 'react';\n\nconst Main = ({ children }) => {\n  return (\n    <div className='main'>\n      {children}\n    </div>\n  );\n};\n\nexport default Main;","import React from 'react';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport Coin from '../components/Coin';\nimport Header from '../components/Header';\nimport Home from '../components/Home';\nimport Main from '../components/Main';\n\nconst AppRouter = (props) => {\n  return (\n    <Router basename='/test-api'>\n      <Header />\n      <Main>\n        <Switch>\n          <Route path='/' exact component={Home} />\n          <Route path='/coin' exact component={Coin} />\n          <Route path='*' render={() => <div>Not Found</div>} />\n        </Switch>\n      </Main>\n    </Router>\n  );\n};\n\nexport default AppRouter;","import AppRouter from \"./routing/AppRouter\";\n\nfunction App() {\n  return (\n    <div className='app'>\n      <AppRouter />\n    </div>\n  )\n}\n\nexport default App;\n","import { constans } from \"../constans\";\n\nconst initState = {\n  data: null,\n  diff: null,\n  range: '10'\n}\n\nconst coinReduser = (state = initState, action) => {\n  switch (action.type) {\n\n    case constans.COIN.SET_COIN_SUCCESS:\n      const { price } = action.payload\n      const _diff = state.data ? (+price / state.data.price - 1) * 100 : ''\n      return { ...state, data: action.payload, diff: _diff }\n\n    case constans.COIN.SET_RANGE_SUCCESS:\n      return { ...state, range: action.payload }\n\n    default:\n      return state\n  }\n}\n\nexport default coinReduser;","import { createStore, combineReducers, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport coinReducer from './reducers/coin'\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst reducers = combineReducers({\n  coin: coinReducer\n})\n\nconst store = createStore(reducers, /* preloadedState, */ composeEnhancers(applyMiddleware(thunk)));\n\nexport default store;","import 'bootstrap/dist/css/bootstrap.css';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport App from './App';\nimport './index.css';\nimport store from './store/index';\n\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);"],"sourceRoot":""}